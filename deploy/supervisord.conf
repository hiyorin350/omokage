[supervisord]
nodaemon=true
logfile=/dev/stdout
pidfile=/tmp/supervisord.pid

[program:backend]
directory=/app/backend
command=/venv/bin/gunicorn config.wsgi:application -b 0.0.0.0:10001 --workers 3 --timeout 60
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
autorestart=true
priority=10

[program:frontend]
directory=/app/frontend/.next/standalone
; Next の standalone サーバを $PORT で 0.0.0.0 にバインド
command=node server.js -p ${PORT}
environment=PORT=10000,NODE_ENV=production
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
autorestart=true
priority=20
