[supervisord]
nodaemon=true
user=root
logfile=/dev/stdout
logfile_maxbytes=0
logfile_backups=0
pidfile=/tmp/supervisord.pid
childlogdir=/var/log/supervisor

[program:backend]
directory=/app/backend
command=/app/venv/bin/python -m gunicorn config.wsgi:application -b 0.0.0.0:10001 --workers 3 --timeout 60
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stdout_logfile_backups=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
stderr_logfile_backups=0
autorestart=true
priority=10

[program:frontend]
directory=/app
; ★ ポイント1: 余計な -p はやめて、env に任せる
command=node server.js

; ★ ポイント2: PORT/HOSTNAME を環境変数で渡す
;   - PORT は Render が注入する値（例: 10000）
;   - %(ENV_PORT)s は「元の環境変数 PORT をそのまま使う」の意味
environment=NODE_ENV=production,PORT=%(ENV_PORT)s,HOSTNAME=0.0.0.0

stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stdout_logfile_backups=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
stderr_logfile_backups=0
autorestart=true
priority=20
